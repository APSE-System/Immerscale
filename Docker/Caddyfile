(cors) {
    @origin header Origin {args.0}
    header @origin Access-Control-Allow-Origin "{args.0}"
    header @origin Access-Control-Allow-Methods "OPTIONS,HEAD,GET,POST,PUT,PATCH,DELETE"
}



immerscale.de {
    tls /etc/caddy/certs/immerscale.de.crt /etc/caddy/certs/immerscale.de.key {
       ca /etc/caddy/certs/immerscale-ca.crt
    }
    # Handle CORS preflight requests
    @preflight {
        method OPTIONS
        header Access-Control-Request-Method *
        header Origin *
    }
    handle @preflight {
        header Access-Control-Allow-Origin "https://immerscale.de:8888"
        header Access-Control-Allow-Methods "*"
        header Access-Control-Allow-Headers "content-type"
        header Access-Control-Allow-Credentials "true"
        respond 200
    }

    reverse_proxy /test respond "yeah"

    reverse_proxy /* backend:8080
}
